监控工具：哨兵监控平台

监控项：基础、网卡

### ![](/assets/5-4-1.png) {#id-第四节网络-}

监控项说明



### 网络带宽占用率 {#id-第四节网络-网络带宽占用率}

一个最大速率是100Mb的交换机端口，进来的流量是20Mbps，出去的流量是10Mbps。  
入口带宽利用率：20Mb/100Mb=20%  
出口带宽利用率：10Mb/100Mb=10%  
网络带宽占用率是**通过进出流量与带宽的比值计算得来**的，查看网络流量的命令：

### 网络吞吐量 {#id-第四节网络-网络吞吐量}

单位时间内通过某个网络（或信道、接口）的数据量，吞吐量受网络的带宽或者网络的额定速率限制的，例如家庭带宽为10M网络，表明网络吞吐量不可能超过10Mbits/s，吞吐量的单位通常表示为位元每秒（bit/s或bps）。  
网络吞吐量可以帮组寻找网络路径中的瓶颈。比如，即使 client 和 server 都被分别连接到各自的 100M Ethernet 上，但是如果这两个 100M 的Ethernet 被 10M 的 Ethernet 连接起来，那么 10M 的 Ethernet 就是网络的瓶颈。  
  


### 丢包率 {#id-第四节网络-丢包率}

丢包率（Loss Tolerance或packet loss rate）是指测试中所丢失数据包数量占所发送数据包的比率，通常在吞吐量范围内测试。丢包率与数据包长度以及包发送频率相关。通常，千兆网卡在流量大于200Mbps时，丢包率小于万分之五；百兆网卡在流量大于60Mbps时，丢包率小于万分之一。TCP协议是可靠的，所以，一般在使用UDP传输时，才会统计丢包率。  
  


### 连接数 {#id-第四节网络-连接数}

套接字（socket）是通信的基石，是支持TCP/IP协议的网络通信的基本操作单元。它是网络通信过程中端点的抽象表示，包含进行网络通信必须的五种信息：连接使用的协议，本地主机的IP地址，本地进程的协议端口，远地主机的IP地址，远地进程的协议端口。  
应用层可以和传输层通过Socket接口，区分来自不同应用程序进程或网络连接的通信，实现数据传输的并发服务。创建Socket连接时，可以指定使用的传输层协议，Socket可以支持不同的传输层协议（TCP或UDP）。  
![](/assets/5-4-2.png)





**连接数的限制**

**打开文件数量的限制**：在Linux平台上，无论编写客户端程序还是服务端程序，在进行高并发TCP连接处理时，最高的并发数量都要受到系统对用户单一进程同时可打开文件数量的限制\(这是因为系统为每个TCP连接都要创建一个socket句柄，每个socket句柄同时也是一个文件句柄\)。可使用ulimit命令查看系统允许当前用户进程打开的文件数限制：ulimit -n，表示当前用户的每个进程最多允许同时打开的文件数目，缺省情况下，基于Linux的通讯程序最多允许同时1014个TCP并发连接。  
**端口号范围太小的限制**：Linux内核的TCP/IP协议实现模块对系统中所有的客户端TCP连接对应的本地端口号的范围进行了限制。当系统中某一时刻同时存在太多的TCP客户端连接时，由于每个TCP客户端连接都要占用一个唯一的本地端口号\(此端口号在系统的本地端口号范围限制中\)，如果现有的TCP客户端连接已将所有的本地端口号占满，则此时就无法为新的TCP客户端连接分配一个本地端口号了，因此系统会在这种情况下在connect\(\)调用中返回失败，并将错误提示消息设为"Can't assign requested address"。请注意，本地端口范围的最小值必须大于或等于1024；而端口范围的最大值则应小于或等于65535。  
理论上单独一个进程最多可以同时建立60000多个TCP客户端连接。  
[http://blog.csdn.net/guowake/article/details/6615728](http://blog.csdn.net/guowake/article/details/6615728)

